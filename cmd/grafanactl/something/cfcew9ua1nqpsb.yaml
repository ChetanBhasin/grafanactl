annotations:
  description: "Karpenter has been encountering cloud provider errors for at least 10 minutes (controller={{ $labels.controller }}, error={{ $labels.error }}). Errors in the last 5 minutes: {{ printf \"%.0f\" $values.B.Value }}. Autoscaling may be impaired."
  runbook_url: https://github.com/zetamarkets/terraform-infrastructure/wiki/Runbooks
  summary: Karpenter cloud provider errors detected in mainnet
condition: C
data:
  - datasourceUid: victoria-metrics-mainnet
    model:
      editorMode: code
      expr: sum by (controller, error) (increase(karpenter_cloudprovider_errors_total{controller!~"node.termination|nodeclaim.termination", error!="NodeClaimNotFoundError"}[5m]))
      intervalMs: 15000.0
      maxDataPoints: 1000.0
      refId: A
    refId: A
    relativeTimeRange:
      from: 600
  - datasourceUid: __expr__
    model:
      datasource:
        type: __expr__
        uid: __expr__
      expression: A
      intervalMs: 1000.0
      maxDataPoints: 43200.0
      reducer: last
      refId: B
      settings:
        mode: dropNN
      type: reduce
    refId: B
    relativeTimeRange: {}
  - datasourceUid: __expr__
    model:
      conditions:
        - evaluator:
            params:
              - 0.0
            type: gt
          unloadEvaluator:
            params:
              - 0.0
            type: lte
      datasource:
        type: __expr__
        uid: __expr__
      expression: B
      intervalMs: 1000.0
      maxDataPoints: 43200.0
      refId: C
      type: threshold
    refId: C
    relativeTimeRange: {}
execErrState: OK
folderUID: alerts
for: 10m0s
id: 152
labels:
  alert_type: node_health
  environment: mainnet
  severity: warning
  team: platform
noDataState: OK
orgID: 1
provenance: api
ruleGroup: "Mainnet - Node Health"
title: Karpenter CloudProvider Errors
uid: cfcew9ua1nqpsb
updated: "2026-02-13T12:51:06.000Z"
